var Type_Physical=0,Type_Virtual=1,State_Idle=0,State_Building=1;function Agent(){this.Id,this.Type=Type_Physical,this.Name,this.State=State_Idle,this.IP,this.Url,this.Resources=[],this.Available=!1}function History(){this.Url,this.AgentId}function GenerateAgentView(e,t){var o=document.createElement("div");e.forEach(function(e,t){var a=AgentTemplate,s=ResourceTemplate;for(var n in e)e.hasOwnProperty(n)&&(a=a.replace(new RegExp("\\${"+n+"}","g"),e[n]));a=a.replace(/\${index}/g,"agent"+t),s=s.replace(/\${index}/g,"agent"+t);var i=e.Available?"hidden":"";a=a.replace(/\${execDenyClass\(\)}/g,i);var r=0==e.State?"idle":"building",c=0==e.Type?" physical":" virtual";a=(a=a.replace(/\${execStateValue\(\)}/g,r)).replace(/\${execStateClass\(\)}/g,r+c);var l="";e.Resources.forEach(function(e,t){l+=s.replace(/\${template}/g,e)}),a=a.replace(/\${execResource\(\)}/g,l),o.innerHTML+=a}),t.appendChild(o)}function OnSpecifyResource(){event.preventDefault();var e=this.getCurrentAgentIndexClass(),t=document.querySelector(".popup"+e);t.className=t.className.replace(/hidden/g,"").trim(" ")}function OnAdd(){var a=this.getCurrentAgentIndexClass(),e=document.querySelector(a+" .resource-input"),t=document.querySelector(".popup"+a+" .label-text"),s=document.querySelector(".popup"+a+" .error-text");if(/^(\w+)(, \w+)*$/.test(e.value)){t.className=t.className.replace(/hidden|\s/g,""),s.className=s.className.replace(/display|\s/g,"");var n=this;e.value.split(", ").forEach(function(e){var t=document.createElement("div");t.className="resource "+a.replace(/\./,""),t.addEventListener("click",function(){if(/remove/g.test(event.target.className)){var e=n.getCurrentAgentIndexClass();document.querySelector(".resource-container"+e).removeChild(event.currentTarget)}}),t.innerHTML='<span class="resource-text">'+e+'</span><i class="remove">+</i>',document.querySelector(".resource-container"+a).appendChild(t)}),e.value="",this.OnClose()}else-1==s.className.indexOf("display")&&(s.className+=" display",t.className+=" hidden")}function OnClose(){var e=this.getCurrentAgentIndexClass();document.querySelector(".popup"+e).className+=" hidden"}function OnRemove(){if(/remove/g.test(event.target.className)){var e=this.getCurrentAgentIndexClass();document.querySelector(".resource-container"+e).removeChild(event.currentTarget)}}function OnDenyClick(){event.preventDefault()}function getCurrentAgentIndexClass(){var e=event.currentTarget.className.match(/agent\d/g);if(!e||!e.length||1!=e.length)throw"cannot match agent index...";return"."+e[0]}var ResourceTemplate='<div class="resource ${index}" onclick="OnRemove()"><span class="resource-text">${template}</span><i class="remove">+</i></div>',AgentTemplate='<div class="agent-info-container ${execStateClass()}">                         <div class="circle-icon"></div>                         <div class="content-panel">                             <div class="row">                                 <div class="agent-name col-md-6" title="${Name}">${Name}</div>                                 <div class="rightTop-panel col-md-6" title="| ${execStateValue()} | ${IP} | ${Url}">                                     | <span>${execStateValue()}</span> | <span>${IP}</span> | <span>${Url}</span>                                 </div>                             </div>                             <div class="row">                                 <div onclick="OnSpecifyResource()" style="display:inline-block" class="${index}">                                     <span class="plus">+</span>                                     <a href="" class="add-resource">Specify Resource</a>                                 </div>                                 <div class="resource-container ${index}">                                     <span>| Resources:</span>                                     ${execResource()}                                 </div>                             </div>                         </div>                         <div class="deny-container ${execDenyClass()}">                             <i></i>                             <a href="" onclick="OnDenyClick()">Deny</a>                         </div>                     </div>                     <div style="position:relative;">                         <div class="popup hidden ${index}">                             <i class="i1">                                 <i class="i2">                                 </i>                             </i>                             <div class="label-text" title="(separate multiple resources name with commas)">(separate multiple resources name with commas)</div>                             <div class="error-text">error format...add like this format 1, 2</div>                            <input class="resource-input" type="text">                             <div class="btn-area">                                 <button onclick="OnAdd()" class="${index}">Add resources</button><button onclick="OnClose()" class="${index}">Close</button>                             </div>                         </div>                     </div>                     ';function GenerateHistoryView(e,t){var a=document.createElement("div");e.forEach(function(e){a.innerHTML+='<div class="history" title="'+e.Url+'">'+e.Url+"</div>"}),t.appendChild(a)}